!function(){"use strict";window.FPFront||(window.FPFront={});var t={},e=null,a=new Map,n=new Map;function r(t){if(!t)return null;var e=String(t),a=-1!==e.indexOf("T"),n=-1!==e.indexOf(" "),r=/[zZ]|[+-]\d{2}:?\d{2}$/.test(e),i=e;if(n&&(i=e.replace(" ","T")),!r){if(!a&&!n)return null;i+="Z"}var s=new Date(i);return isNaN(s.getTime())?null:s}function i(e,a){try{var n=r(String(e)),i=r(String(a));if(!n||!i)throw new Error("Invalid date");var s={hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:t&&t.timezone||void 0},o=new Intl.DateTimeFormat(void 0,s);return o.format(n)+" - "+o.format(i)}catch(t){var c=function(t){var e=String(t).match(/\d{2}:\d{2}/);return e&&e[0]||""},d=c(e),f=c(a);return d&&f?d+" - "+f:"Slot"}}window.FPFront.availability={init:function(a){t=a&&a.config||{},e=a&&a.calendarEl||null,a&&a.widget||null,function(){n=new Map;var e=t&&t.calendar||{};Object.keys(e).forEach(function(t){var a=e[t]&&e[t].days?e[t].days:{};Object.keys(a).forEach(function(t){n.set(t,a[t]||[])})})}()},formatTimeRange:i,fetchAvailability:async function(e){var a=t&&t.experienceId||0;if(!a||!e)return[];try{var n=window.fpExpApiBase&&"string"==typeof window.fpExpApiBase?window.fpExpApiBase:window.wpApiSettings&&wpApiSettings.root||location.origin+"/wp-json/",r=n.endsWith("/")?n:n+"/",s=new URL(r+"fp-exp/v1/availability");s.searchParams.set("experience",String(a)),s.searchParams.set("start",e),s.searchParams.set("end",e);var o=await fetch(s.toString(),{credentials:"same-origin"});if(!o.ok)throw new Error("HTTP "+o.status);var c=await o.json();return(Array.isArray(c&&c.slots)?c.slots:[]).map(function(t){return{start:t.start||"",end:t.end||"",label:t.start&&t.end?i(t.start,t.end):void 0}})}catch(t){throw t}},prefetchMonth:async function(r){var s=t&&t.experienceId||0;if(s&&r&&!a.has(r))try{var o=window.fpExpApiBase&&"string"==typeof window.fpExpApiBase?window.fpExpApiBase:window.wpApiSettings&&wpApiSettings.root||location.origin+"/wp-json/",c=o.endsWith("/")?o:o+"/",d=r+"-01",f=new Date(d+"T00:00:00");f.setMonth(f.getMonth()+1),f.setDate(0);var p=f.toISOString().slice(0,10),w=new URL(c+"fp-exp/v1/availability");w.searchParams.set("experience",String(s)),w.searchParams.set("start",d),w.searchParams.set("end",p);var l=await fetch(w.toString(),{credentials:"same-origin"});if(!l.ok)throw new Error("HTTP "+l.status);var u=await l.json(),h=Array.isArray(u&&u.slots)?u.slots:[],g=new Map,v=new Map;h.forEach(function(t){var e=(t.start||"").slice(0,10);g.set(e,(g.get(e)||0)+1),v.has(e)||v.set(e,[]),v.get(e).push({start:t.start||"",end:t.end||"",label:t.start&&t.end?i(t.start,t.end):void 0,remaining:t.capacity_remaining||0})}),a.set(r,g),v.forEach(function(t,e){n.set(e,t)}),e&&e.querySelectorAll('.fp-exp-calendar__day[data-date^="'+r+'"]').forEach(function(t){var e=t.getAttribute("data-date"),a=e&&g.get(e)||0;t.dataset.available=a>0?"1":"0"})}catch(t){}},monthKeyOf:function(t){return(t||"").slice(0,7)},getCalendarMap:function(){return n}}}();